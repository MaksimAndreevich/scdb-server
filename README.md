# SCDB Server

Серверная часть системы управления данными образовательных организаций. Проект предоставляет REST API для работы с информацией об образовательных организациях.

## Технологии

- Go 1.24
- PostgreSQL 17.4
- Docker & Docker Compose
- Gin Web Framework
- PostgreSQL Driver (lib/pq)

## Структура проекта

```
.
├── internal/
│   ├── config/         # Конфигурация приложения
│   ├── controllers/    # Обработчики HTTP запросов
│   ├── database/       # Работа с базой данных
│   ├── middleware/     # Промежуточные обработчики
│   ├── models/         # Модели данных
│   ├── repository/     # Слой доступа к данным
│   └── routers/        # Маршрутизация
├── Dockerfile         # Конфигурация Docker образа
├── docker-compose.yml # Конфигурация Docker Compose
├── go.mod            # Зависимости Go
└── main.go           # Точка входа приложения
```

## API Endpoints

### Публичные маршруты

- `POST /api/register` - Регистрация пользователя
- `POST /api/login` - Авторизация пользователя
- `GET /api/organisations/total` - Получение общего количества организаций

### Защищенные маршруты

- `GET /api/organisations` - Получение списка организаций
  - Query параметры:
    - `search` - Поиск по названию или региону
    - `limit` - Количество записей (по умолчанию 20)
    - `offset` - Смещение (по умолчанию 0)
- `GET /api/organisations/:id` - Получение информации об организации по ID

## Запуск проекта

### Требования

- Docker
- Docker Compose

### Локальный запуск

1. Клонируйте репозиторий:

```bash
git clone <repository-url>
cd server
```

2. Запустите проект:

```bash
docker-compose up --build
```

Запустить без кеша

```bash
docker-compose up --no-cache
```

3. Остановка проекта:

```bash
docker-compose down -v
```

4. Посмотреть запущеные контейнеры:

```bash
docker ps
```

5. Посмотреть логи

```bash
docker-compose logs -f
```

### Переменные окружения

Проект использует следующие переменные окружения:

- `DB_HOST` - Хост базы данных (по умолчанию: db)
- `DB_PORT` - Порт базы данных (по умолчанию: 5432)
- `DB_USER` - Пользователь базы данных (по умолчанию: user)
- `DB_PASSWORD` - Пароль базы данных (по умолчанию: password)
- `DB_NAME` - Имя базы данных (по умолчанию: db)

## База данных

Проект использует PostgreSQL. При первом запуске автоматически создаются необходимые таблицы:

- `education_organizations` - Таблица с информацией об образовательных организациях

## Разработка

### Структура базы данных

Таблица `education_organizations` содержит следующие поля:

- `id` - Уникальный идентификатор
- `full_name` - Полное наименование
- `short_name` - Сокращенное наименование
- `head_edu_org_id` - ID головной организации
- `is_branch` - Является ли филиалом
- `post_address` - Юридический адрес
- `phone` - Телефон
- `fax` - Факс
- `email` - Email
- `web_site` - Веб-сайт
- `ogrn` - ОГРН
- `inn` - ИНН
- `kpp` - КПП
- `head_post` - Должность руководителя
- `head_name` - ФИО руководителя
- `form_name` - Организационно-правовая форма
- `kind_name` - Вид организации
- `type_name` - Тип организации
- `region_name` - Субъект РФ
- `federal_district_short_name` - Сокращенное наименование федерального округа
- `federal_district_name` - Полное наименование федерального округа
